--- Undervalued Players
-- order by (fg_percentage / average_minutes ) desc

--- Most Valuables short player
-- order by (o.plus_minus_avg / p.Height) desc

--- Skinny
-- order by (p.Height/p.Weight)


create view player_improvement as
select ssn, sum(if((half = 1), -rating, rating)) as 'improvement' from
(select ssn, avg(rating) as 'rating', tile_nr as 'half' from
(select pgs.ssn, ntile(2) over(order by pgs.Game_date) as tile_nr, (pgs.fg_made/pgs.fg_attempt) as 'rating', g.Game_date 
from game g, player_game_statistics pgs 
where (pgs.Home_team = 'Alpha' or pgs.Away_team = 'Alpha') and pgs.Home_team = g.Home_team 
and pgs.Away_team = G.Away_team and pgs.Game_date = g.Game_date) as tbl
group by tile_nr, ssn) as tbl
group by ssn